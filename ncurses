#include <stdio.h>
#include <ncurses.h>

#define WIDTH 25
#define HEIGHT 8 

char *choices[] = {
        "draw card",
        "stay",
        "betting"
          };

typedef struct card{

        char type[6];
        char color[6];
        int number;

}card;

typedef struct person{

        card *cards;
        int card_num;
}person;

//variable
int startx = 0;
int starty = 0;
int mod = 1;
int n_choices = sizeof(choices) / sizeof(char *);

//method
void print_menu(WINDOW *menu_win, int highlight);
void print_Player(WINDOW * , person *);


int main()
{
        //start window
        WINDOW *menu_win;
        WINDOW *Dealer_win;
        WINDOW *Player_win;
        int highlight = 1;
        int choice = 0;
        int c;

        //example card
        card cards[2]={{"spade","black",10},{"heart","red",4}};
        person Dealer = {cards,2};
        person Player = {cards,2};

        //setting
        initscr();
        clear();
        noecho();
        cbreak();       /* Line buffering disabled. pass on everything */

        //box location
        startx = (80 - WIDTH) / 2;
        starty = (24 - HEIGHT) / 2;

        //color
        start_color();
        init_pair(1,COLOR_WHITE,COLOR_BLACK);
        init_pair(2,COLOR_BLACK,COLOR_WHITE);
        wattron(menu_win,COLOR_PAIR(1));

        //call window
        menu_win = newwin(HEIGHT, WIDTH, starty, startx);
        Dealer_win = newwin(HEIGHT, WIDTH, 0, startx);
        Player_win = newwin(HEIGHT, WIDTH, starty+8, startx);

        //set keypad
        keypad(menu_win, TRUE);
        //mvprintw(0, 0, "choose your choice");
        refresh();

        //print
        print_menu(menu_win, highlight);
        print_Player(Dealer_win,&Dealer);
        print_Player(Player_win,&Player);

        while(1)
        {       c = wgetch(menu_win);
                switch(c)
                {
                        case KEY_UP:
                                if(highlight == 1)

                                        highlight = n_choices;
                                else
                                        --highlight;
                                break;
                        case KEY_DOWN:
                                if(highlight == n_choices)
                                        highlight = 1;
                                else
                                        ++highlight;
                                break;
                        case '1':
                                //wattroff(menu_win,COLOR_PAIR(2));
                                //wattron(menu_win,COLOR_PAIR(1));
                                highlight =1;
                                break;
                        case '2':
                                //wattroff(menu_win,COLOR_PAIR(1)); 
                                //wattron(menu_win,COLOR_PAIR(2));
                                highlight =2;
                                break;
                        case '3':
                                highlight =3;
                                break;
                        case KEY_ENTER: // enter key at the key pad
                                return highlight;
                        case 10: // enter key
                                choice = highlight;
                                break;
                        default:
                                //mvprintw(1, 0, "(Charcter pressed = %3d or '%c')", c, c);
                                refresh();
                                break;
                }
                print_menu(menu_win, highlight);
                if(choice != 0) /* User did a choice come out of the infinite loop */
                        break;
        }
        clrtoeol();
        refresh();
        endwin();
        printf("You chose choice %d with choice string %s\n", choice, choices[choice - 1]);
        return 0;
}

void print_menu(WINDOW *menu_win, int highlight)
{
        int x, y, i;

        //position
        x = 2;
        y = 2;
        box(menu_win, 0, 0);

        //menu print
        mvwprintw(menu_win, y, x, "%s", "choose your select");
        y++;
        mvwprintw(menu_win, y, x, "%s", "");

        for(i = 0; i < n_choices; ++i)
        {
                ++y;
                if(highlight == i + 1) /* High light the present choice */
                {
                        wattron(menu_win, A_REVERSE);
                        mvwprintw(menu_win, y, x, "%s", choices[i]);
                        wattroff(menu_win, A_REVERSE);
                }
                else
                        mvwprintw(menu_win, y, x, "%s", choices[i]);

        }
        wrefresh(menu_win);
}


void print_Player(WINDOW *Player_win, person *Player)
{
        int x,y,i,card_num;
        card *cards;

        //position
        x=3;
        y=3;
        box(Player_win, 0, 0);

        //card contents
        cards = (Player -> cards);
        card_num = Player -> card_num;

        for(i = 0; i < card_num; ++i)
        {
                mvwprintw(Player_win, y, x, "%s %d",cards->type,cards->number );
                cards++;
                y++;

        }
        wrefresh(Player_win);
}














